#+TITLE: Theme Cyanide
#+STARTUP: overview
#+PROPERTY: header-args  :tangle ./cyanide-light-theme.el  :noweb yes  :results output silent


This file looks OK when rendered on github, but it is probably best read in =emacs=.

* Philosophy
The main idea behind this theme is to rely on colors and font size to quickly identify the structure of a text file (be it the org-mode file containing my bibliography, an org-roam entry, a python file, or a markdown file). A first inspiration for this was the [[https://github.com/fniessen/emacs-leuven-theme][emacs-leuven-theme]], however, due to the various use cases I have for org-mode, I also wanted headings not to look too different from the regular text.

My solution to this problem is to rely on two hacks:
- by setting =org-num-face= to have a high contrast with the text (in the screenshot below, it corresponds to the numbers in black on =cyan=), I obtain a very visible structure for documents,
- by drawing a thick box around headings that is of the same color as the actual background, I effectively obtain vertical margins around them that further highlight the structure.

#+CAPTION: screencap of this file rendered in cyanide-theme
[[./figures/screencap-readme.png]]

Then, I applied this general principle in other places: first in =markdown-mode=, where I colored the =#= symbols, and then in LaTeX files, where =(sub*)section= is in blue, and where the titles have the big brown fonts with the margins.
* Setup
** Colors
#+NAME: std-color
#+BEGIN_SRC elisp :tangle no
#393939
#+END_SRC

The =ivory2= color
#+NAME: std-background
#+BEGIN_SRC elisp :tangle no
#eeeee8
#+END_SRC

#+NAME: other-background
#+BEGIN_SRC elisp :tangle no
thistle
#+END_SRC

#+NAME: highlight-background
#+BEGIN_SRC elisp :tangle no
lemon chiffon
#+END_SRC

#+NAME: outline-background
#+BEGIN_SRC elisp :tangle no
#eeeee8
#+END_SRC

=DeepSkyBlue1=

#+NAME: structure-background
#+BEGIN_SRC elisp :tangle no
#87cefa
#+END_SRC

#+NAME: structure-color
#+BEGIN_SRC elisp :tangle no
#000000
#+END_SRC

** Additional fonts
*** Face for heading markers 
#+BEGIN_SRC elisp
  (defface cyanide-num-face
    '((t . (:weight bold :background "<<structure-background>>" :foreground "<<structure-color>>")))
    "A font for heading markers")
#+END_SRC
*** Face for class names
#+BEGIN_SRC elisp
  (defface cyanide-class-name-face
      '((t . (:background "<<highlight-background>>" :foreground "dark orange" :weight bold :height 1.3)))
      "A font for class names.")
#+END_SRC

** Preamble
#+BEGIN_SRC emacs-lisp 
(deftheme cyanide-light
  "cyanide light theme")

(custom-theme-set-faces ; this parenthesis is closed in the post-amble
 'cyanide-light

#+END_SRC
* Core settings
** Types of fonts


#+BEGIN_SRC emacs-lisp 
 '(default ((t (:foreground "<<std-color>>" :background "<<std-background>>"))))
 '(border ((t (:foreground "black"))))
 '(bold ((t (:weight bold))))
 '(italic ((t (:italic t))))
 '(fg:black ((t (:foreground "black"))))
 '(bold-italic ((t (:italic t :weight bold))))
 '(underline ((t (:underline t))))
#+END_SRC

** Ongoing Typing
#+BEGIN_SRC emacs-lisp 
 '(hl-line ((t (:background "white"))))
 '(mouse ((t (:foreground "black"))))
 '(cursor ((t (:background "red3"))))
 '(region ((t (:background "AntiqueWhite2"))))
 '(highlight ((t (:background "LightSteelBlue1"))))
#+END_SRC
** Basic Types
#+BEGIN_SRC emacs-lisp 
 '(list-matching-lines-face ((t (:weight bold))))
 '(view-highlight-face ((t (:background "<<std-background>>"))))
 '(gui-button-face ((t (:foreground "light grey"))))
 '(secondary-selection ((t (:background "paleturquoise"))))
 '(custom-button-face ((t (:background "cyanide" :foreground "dark cyan"))))
 '(custom-documentation-face ((t (:background "cyanide"))))
#+END_SRC
* Colors for Specific Uses
** TODO Mode line :ongoingWork:
#+BEGIN_SRC emacs-lisp 
 '(mode-line ((t (:background "burlywood3" :foreground "wheat1"))))
 '(mode-line-buffer-id ((t (:background "dark slate gray" :foreground "wheat1"))))
 '(mode-line-mousable ((t (:background "dark slate gray" :foreground "wheat1"))))
 '(mode-line-mousable-minor-mode ((t (:background "dark slate gray" :foreground "wheat1"))))
#+END_SRC
** Programming

#+BEGIN_SRC emacs-lisp 
 '(font-lock-comment-face ((t (:background "LavenderBlush1" :foreground "dim gray" :weight semi-light))))
 '(font-lock-constant-face ((t (:background "<<std-background>>" :foreground "DarkOrange3"))))
 '(font-lock-builtin-face ((t (:background "<<std-background>>" :foreground "OliveDrab4" :weight semi-bold))))
 '(font-lock-keyword-face ((t (:background "<<std-background>>" :foreground "blue" :weight semi-bold))))
 '(font-lock-string-face ((t (:background "#f3fff0" :foreground "slate gray"))))
 '(font-lock-variable-name-face ((t (:background "<<std-background>>" :foreground "brown"))))
 '(font-lock-function-name-face ((t (:background "<<highlight-background>>" :foreground "saddle brown" :weight semi-bold :height 1.2))))
 '(font-lock-type-face ((t (:background "<<std-background>>" :foreground "Purple3"))))
 '(font-lock-warning-face ((t (:weight bold :background "<<highlight-background>>" :foreground "red"))))

'(cyanide-class-name-face ((t (:background "<<highlight-background>>" :foreground "dark orange" :weight bold :height 1.3))))
#+END_SRC

** Outline-mode

#+NAME: org-heading-template
#+BEGIN_SRC python :var space=0 :var color="tan" :var height=1.0 :var weight="normal" :noweb yes :results output :tangle no
print(
    "((t (:background \"{}\" :foreground \"{}\" :height {} :weight {} :box (:line-width ({} . {}) :color \"{}\"))))".format(
        "<<outline-background>>",
        color,
        height,
        weight,
        space,
        space,
        "<<outline-background>>",
    ), end="")
#+END_SRC

#+RESULTS: org-heading-template


#+BEGIN_SRC emacs-lisp 
'(outline-1 <<org-heading-template(color="#96441f", height=1.5, weight="extra-bold", space=12)>>)
'(outline-2 <<org-heading-template(color="#79432c", height=1.3, weight="semi-bold", space=9)>>)
'(outline-3 <<org-heading-template(color="#653c29", height=1.1, weight="semi-bold", space=6)>>)
'(outline-4 <<org-heading-template(color="#513428", height=1.05, weight="semi-bold", space=3)>>)
'(outline-5 <<org-heading-template(color="#513428", height=1.0, weight="semi-bold", space=2)>>)
#+END_SRC 


# #+BEGIN_SRC emacs-lisp 
# '(outline-1 <<org-heading-template(color="#4477BB", height=1.4, weight="extra-bold", space=10)>>)
# '(outline-2 <<org-heading-template(color="#4477AA", height=1.3, weight="semi-bold", space=7)>>)
# '(outline-3 <<org-heading-template(color="#446677", height=1.2, weight="semi-bold", space=5)>>)
# '(outline-4 <<org-heading-template(color="#113355", height=1.05, weight="semi-bold", space=3)>>)
# '(outline-5 <<org-heading-template(color="#001833", height=1.0, weight="semi-bold", space=2)>>)
# #+END_SRC 

For meuporg, maybe grab the function [[./meuporg.el::#meuporg/fontify][meuporg/fontify]] and move it here; or do something that would enable the fonts to be set elsewhere.

** Markdown

#+BEGIN_SRC emacs-lisp 
  '(markdown-header-face-1 ((t (:inherit 'org-document-title))))
  '(markdown-header-face-2 ((t (:inherit 'outline-1))))
  '(markdown-header-face-3 ((t (:inherit 'outline-2))))
  '(markdown-header-face-4 ((t (:inherit 'outline-3))))
  '(markdown-inline-code-face ((t (:inherit 'org-verbatim))))
  '(markdown-code-face ((t (:inherit 'org-verbatim))))
  '(markdown-header-delimiter-face ((t (:inherit 'cyanide-num-face))))
#+END_SRC 

** Org-mode
Org-mode headings inherit their styling from the =outline-mode= font faces defined just above, so we only to specify the rest.

*** The title and its comment
#+BEGIN_SRC emacs-lisp 
'(org-document-title ((t (:background "<<structure-color>>" :foreground "<<structure-background>>" :height 1.8 :weight semi-bold))))
'(org-document-info-keyword  ((t (:background "<<structure-background>>" :foreground "<<structure-color>>" :height 0.8 :weight semi-light))))
#+END_SRC

*** Code blocks
#+BEGIN_SRC emacs-lisp 
'(org-block-begin-line  ((t (:background "moccasin" :foreground "Brown4" :underline (:color "<<std-background>>")))))
'(org-block ((t (:background "old lace"))))
'(org-block-end-line  ((t (:background "moccasin" :foreground "Brown4"))))
#+END_SRC

*** Org specific Concepts
#+BEGIN_SRC emacs-lisp 
'(org-verbatim ((t (:background "old lace" :foreground "dark olive green"))))
'(org-link ((t (:foreground "midnight blue" :background "alice blue" :underline (:color "gray" :style dashes)))))
'(org-tag  ((t (:background "<<std-background>>" :foreground "steel blue" :weight semi-light :height 0.8))))
'(org-drawer  ((t (:background "<<std-background>>" :foreground "#727272" :weight semi-light :height 0.7))))
'(org-table  ((t (:background "<<std-background>>" :foreground "Purple3" :weight semi-light :height 0.9))))

#+END_SRC 

*** Keywords (TODO et al.)

#+BEGIN_SRC emacs-lisp 
'(org-headline-done ((t (:foreground "dark green" :background "<<std-background>>"))))
'(org-headline-todo ((t (:foreground "brown"))))
#+END_SRC 


# TODO keywords also need proper fontification.

# #+BEGIN_SRC emacs-lisp :tangle cyanide-light-theme.el :results output silent :noweb yes
# '(org-document-title ((t (:background "white" :foreground "black" :height 1.8 :weight semi-bold))))

# '(org-verbatim ((t (:background "<<std-background>>" :foreground "SlateGray4" :weight semi-bold))))
# '(org-link ((t (:background "alice blue" :foreground "blue" :underline t))))


# '(org-block-begin-line  ((t (:background "wheat2" :foreground "Brown4" :underline (:color "<<std-background>>" :style line :position -3)))))
# '(org-block ((t (:background "wheat1"))))
# '(org-block-end-line  ((t (:background "wheat2" :foreground "Brown4" :overline "<<std-background>>"))))
# #+END_SRC 

*** LaTeX

#+BEGIN_SRC emacs-lisp
'(font-latex-sectioning-1-face ((t (:inherit 'org-document-title))))
'(font-latex-sectioning-2-face ((t (:inherit 'outline-1))))
'(font-latex-sectioning-3-face ((t (:inherit 'outline-2))))
'(font-latex-sectioning-4-face ((t (:inherit 'outline-3))))
'(font-latex-sectioning-5-face ((t (:inherit 'outline-4))))

'(font-latex-math-face ((t (:background "<<std-background>>" :foreground "DarkGoldenrod4" :weight thin))))
'(font-latex-script-char-face ((t (:background "<<std-background>>" :foreground "DarkGoldenrod2" :weight thin))))
#+END_SRC

** Other
#+BEGIN_SRC emacs-lisp 
 '(calendar-today-face ((t (:underline t))))
 '(diary-face ((t (:foreground "red"))))
 '(gnus-mouse-face ((t (:background "LightSteelBlue1"))))
 '(gnus-group-mail-1-empty-face ((t (:foreground "DeepPink3"))))
 '(gnus-group-mail-1-face ((t (:weight bold :foreground "DeepPink3"))))
 '(gnus-group-mail-2-empty-face ((t (:foreground "HotPink3"))))
 '(gnus-group-mail-2-face ((t (:weight bold :foreground "HotPink3"))))
 '(gnus-group-mail-3-empty-face ((t (:foreground "magenta4"))))
 '(gnus-group-mail-3-face ((t (:weight bold :foreground "magenta4"))))
 '(gnus-group-mail-low-empty-face ((t (:foreground "DeepPink4"))))
 '(gnus-group-mail-low-face ((t (:weight bold :foreground "DeepPink4"))))
 '(gnus-group-news-1-empty-face ((t (:foreground "ForestGreen"))))
 '(gnus-group-news-1-face ((t (:weight bold :foreground "ForestGreen"))))
 '(gnus-group-news-2-empty-face ((t (:foreground "CadetBlue4"))))
 '(gnus-group-news-2-face ((t (:weight bold :foreground "CadetBlue4"))))
 '(gnus-group-news-3-empty-face ((t (nil))))
 '(gnus-group-news-3-face ((t (:weight bold))))
 '(gnus-group-news-low-empty-face ((t (:foreground "DarkGreen"))))
 '(gnus-group-news-low-face ((t (:weight bold :foreground "DarkGreen"))))
 '(gnus-splash-face ((t (:foreground "ForestGreen"))))
 '(gnus-summary-cancelled-face ((t (:background "black" :foreground "yellow"))))
 '(gnus-summary-high-ancient-face ((t (:weight bold :foreground "RoyalBlue"))))
 '(gnus-summary-high-read-face ((t (:weight bold :foreground "DarkGreen"))))
 '(gnus-summary-high-ticked-face ((t (:weight bold :foreground "firebrick"))))
 '(gnus-summary-high-unread-face ((t (:weight bold))))
 '(gnus-summary-low-ancient-face ((t (:italic t :foreground "RoyalBlue"))))
 '(gnus-summary-low-read-face ((t (:italic t :foreground "DarkGreen"))))
 '(gnus-summary-low-ticked-face ((t (:italic t :foreground "firebrick"))))
 '(gnus-summary-low-unread-face ((t (:italic t))))
 '(gnus-summary-normal-ancient-face ((t (:foreground "RoyalBlue"))))
 '(gnus-summary-normal-read-face ((t (:foreground "DarkGreen"))))
 '(gnus-summary-normal-ticked-face ((t (:foreground "firebrick"))))
 '(gnus-summary-normal-unread-face ((t (nil))))
 '(gnus-summary-selected-face ((t (:underline t))))
 '(holiday-face ((t (:background "pink"))))
 '(ibuffer-marked-face ((t (:foreground "red"))))
 '(message-cited-text-face ((t (:foreground "red"))))
 '(message-header-cc-face ((t (:foreground "MidnightBlue"))))
 '(message-header-name-face ((t (:foreground "cornflower blue"))))
 '(message-header-newsgroups-face ((t (:italic t :weight bold :foreground "blue4"))))
 '(message-header-other-face ((t (:foreground "steel blue"))))
 '(message-header-subject-face ((t (:weight bold :foreground "navy blue"))))
 '(message-header-to-face ((t (:weight bold :foreground "MidnightBlue"))))
 '(message-header-xheader-face ((t (:foreground "blue"))))
 '(message-separator-face ((t (:foreground "brown"))))
 '(sgml-comment-face ((t (:foreground "dark green"))))
 '(sgml-doctype-face ((t (:foreground "maroon"))))
 '(sgml-end-tag-face ((t (:foreground "blue2"))))
 '(sgml-entity-face ((t (:foreground "red2"))))
 '(sgml-ignored-face ((t (:background "gray90" :foreground "maroon"))))
 '(sgml-ms-end-face ((t (:foreground "maroon"))))
 '(sgml-ms-start-face ((t (:foreground "maroon"))))
 '(sgml-pi-face ((t (:foreground "maroon"))))
 '(sgml-sgml-face ((t (:foreground "maroon"))))
 '(sgml-short-ref-face ((t (:foreground "goldenrod"))))
 '(sgml-start-tag-face ((t (:foreground "blue2"))))
 '(show-paren-match-face ((t (:background "SlateGray1"))))
 '(show-paren-mismatch-face ((t (:background "purple" :foreground "white"))))
 '(speedbar-button-face ((t (:foreground "green4"))))
 '(speedbar-directory-face ((t (:foreground "blue4"))))
 '(speedbar-file-face ((t (:foreground "cyan4"))))
 '(speedbar-highlight-face ((t (:background "dark turquoise" :foreground "white"))))
 '(speedbar-selected-face ((t (:underline t :foreground "red"))))
 '(speedbar-tag-face ((t (:foreground "brown"))))


#+END_SRC

* Finishing

#+BEGIN_SRC elisp
) ; closing the parenthesis opened in the preamble

#+END_SRC

We ensure that =org-num-face= is set properly whenever we are in an =org= buffer.

#+BEGIN_SRC elisp
(setopt org-num-face 'cyanide-num-face)
#+END_SRC

** Adding missing fonts in python/cython
C++ doesn't work, something fishy is happening with CC-mode and its friends

#+BEGIN_SRC elisp
  (font-lock-add-keywords
   'python-mode
   '(; python
     ("^[[:blank:]]*class[[:blank:]]+\\(.*\\):" 1 'cyanide-class-name-face t) 
     ; cython
     ("cdef[[:blank:]]+class[[:blank:]]+\\(.*\\):" 1 'cyanide-class-name-face t)
     ("^[[:blank:]]*cppclass[[:blank:]]+\\(.*\\):" 1 'cyanide-class-name-face t) 
     ("\\(cdef\\)[[:blank:]]+" 1 '(:inherit 'font-lock-keyword-face :background "<<other-background>>") t)
     ("\\(cppclass\\)[[:blank:]]+" 1 '(:inherit 'font-lock-keyword-face :background  "<<other-background>>") t)
     ("\\(extern\\)[[:blank:]]+" 1 '(:inherit 'font-lock-keyword-face :background "<<other-background>>") t)
     ("^[[:blank:]]*cdef[[:blank:]]+\\(.*\\)(.*):" 1 'font-lock-function-name-face t)))
#+END_SRC

** Machinery to define the theme
#+BEGIN_SRC elisp
;;;###autoload
(when load-file-name
  (add-to-list 'custom-theme-load-path
               (file-name-as-directory (file-name-directory load-file-name))))



(provide-theme 'cyanide-light)

#+END_SRC

